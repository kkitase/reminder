# タスクリマインダー GAS

スプレッドシートで管理しているタスクの期限を監視し、Google カレンダーへの自動登録とメールでのリマインド通知を行う Google Apps Script (GAS) ツールです。

## 主な機能

- **メールリマインド**: 期限の 7日前、3日前、1日前に担当者へ自動でリマインドメールを送信します。
- **カレンダー連携**: タスクを Google カレンダーのイベントとして自動登録します。
- **重複防止**: すでにカレンダーに登録済みのタスクは二重に登録されません。

## セットアップ手順

### 1. スプレッドシートの準備

以下の列構成を持つスプレッドシートを作成してください（デフォルト設定の場合）。

| 列 | 項目 | 説明 |
| :--- | :--- | :--- |
| A | タスク | タスクの内容 |
| B | ステータス | 「完了」と入力するとリマインド対象外になります |
| C | 担当者 | 担当者の名前（通知やカレンダーに使われます） |
| D | 期限 | タスクの期限日 |
| E | メールアドレス | リマインドメールの送信先 |

### 2. GAS コードの配置

1. スプレッドシートのメニューから [拡張機能] > [Apps Script] を選択します。
2. 開いたエディタに `code.gs` の内容を貼り付けます。

### 3. 設定の変更

コード内の `CONFIG` オブジェクトを環境に合わせて書き換えます。

```javascript
const CONFIG = {
  // スプレッドシートのID
  SPREADSHEET_ID: "ここにスプレッドシートのIDを入力",
  
  // シート名
  SHEET_NAME: "Sheet1",
  
  // その他の設定（列の位置や通知タイミングなど）は必要に応じて変更してください
};
```

### 4. 実行権限の承認と初期設定

1. GAS エディタのツールバーで `createDailyTrigger` 関数を選択し、[実行] をクリックします。
2. 承認を求められるので、許可してください。
   - これにより、毎日午前 9 時に自動実行されるようになります。

## 使用方法

### 自動リマインド
トリガーを設定した後は、毎日 9 時に GAS が自動でスプレッドシートをチェックし、期限が迫っているタスクがあればメールを送信し、カレンダーに登録します。

### 手動での一括更新
カレンダーに未登録のタスクをすぐに登録したい場合は、`createCalendarEventsForAllTasks` 関数を実行してください。

### テスト
正しく動作するか確認するために、以下のテスト用関数を用意しています。
- `sendTestEmail`: 自分のメールアドレスにテストメールを送信します。
- `testCreateCalendarEvent`: スプレッドシートの最初のタスクを使用して、カレンダー登録をテストします。
